# Release Please Workflow
#
# Automates releases based on Conventional Commits:
# 1. Analyzes commits since last release
# 2. Creates/updates a release PR with changelog
# 3. When merged, creates GitHub release and tag
#
# See: https://github.com/googleapis/release-please

name: Release Please

on:
  push:
    branches: [main]

permissions:
  contents: write
  pull-requests: write

jobs:
  release-please:
    name: Release Please
    runs-on: ubuntu-latest
    timeout-minutes: 10

    outputs:
      release_created: ${{ steps.release.outputs.release_created }}
      tag_name: ${{ steps.release.outputs.tag_name }}
      version: ${{ steps.release.outputs.version }}

    steps:
      - name: Release Please
        id: release
        uses: googleapis/release-please-action@7987652d64b4581673a76e33ad5e98e3dd56832f # v4.1.3
        with:
          # Release type determines how version files are updated
          # Options: node, python, simple, go, etc.
          # Use 'node' for package.json, 'python' for pyproject.toml
          # Use 'simple' if you only want CHANGELOG.md updates
          release-type: node

          # Token is automatically provided by GitHub Actions
          # token: ${{ secrets.GITHUB_TOKEN }}

  # Optional: Add post-release jobs here
  # Example: publish to npm, PyPI, Docker Hub, etc.
  #
  # publish:
  #   name: Publish
  #   runs-on: ubuntu-latest
  #   needs: release-please
  #   if: needs.release-please.outputs.release_created == 'true'
  #   steps:
  #     - uses: actions/checkout@v4
  #     - name: Publish to npm
  #       run: npm publish
  #       env:
  #         NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
